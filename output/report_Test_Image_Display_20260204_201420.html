
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Road Damage Survey Report - Test_Image_Display</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .damage-badge { border-radius: 20px; padding: 5px 15px; font-size: 0.8rem; font-weight: bold; }
        .damage-D00 { background-color: #ff6b6b; color: white; }
        .damage-D10 { background-color: #4ecdc4; color: white; }
        .damage-D20 { background-color: #45b7d1; color: white; }
        .damage-D40 { background-color: #f9ca24; color: black; }
        .damage-Repair { background-color: #6c5ce7; color: white; }
        .damage-Block { background-color: #a0a0a0; color: white; }
        
        .severity-critical { background-color: #dc3545; color: white; }
        .severity-severe { background-color: #fd7e14; color: white; }
        .severity-moderate { background-color: #ffc107; color: black; }
        .severity-minor { background-color: #28a745; color: white; }
        
        .priority-1 { background-color: #dc3545; color: white; }
        .priority-2 { background-color: #fd7e14; color: white; }
        .priority-3 { background-color: #ffc107; color: black; }
        .priority-4 { background-color: #28a745; color: white; }
        
        #map { height: 400px; }
        .image-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px; }
        .damage-card { border: 1px solid #ddd; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .damage-card img { width: 100%; height: 200px; object-fit: cover; cursor: pointer; }
        .condition-excellent { background: linear-gradient(135deg, #28a745, #20c997); }
        .condition-good { background: linear-gradient(135deg, #28a745, #ffc107); }
        .condition-fair { background: linear-gradient(135deg, #ffc107, #fd7e14); }
        .condition-poor { background: linear-gradient(135deg, #fd7e14, #dc3545); }
        .condition-critical { background: linear-gradient(135deg, #dc3545, #6f42c1); }
        
        .stats-card { border-radius: 15px; padding: 20px; margin-bottom: 20px; color: white; }
        .detail-section { background: #f8f9fa; border-radius: 10px; padding: 20px; margin: 20px 0; }
        .timeline-item { border-left: 3px solid #007bff; padding-left: 15px; margin-bottom: 15px; }
        .cost-breakdown { background: white; border-radius: 10px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        
        .image-modal img { max-width: 100%; height: auto; }
    </style>
</head>
<body>
    <div class="container-fluid">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="text-center py-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 15px;">
                    <h1><i class="fas fa-road"></i> Road Damage Survey Report</h1>
                    <h3>Test_Image_Display</h3>
                    <p class="mb-0">Survey Date: 2026-02-04</p>
                </div>
            </div>
        </div>
        
        <!-- Overall Condition -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="stats-card condition-excellent">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h2><i class="fas fa-clipboard-check"></i> Overall Road Condition: EXCELLENT</h2>
                            <p class="h5">No damage detected - road in excellent condition</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="display-4">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Summary Statistics -->
        <div class="row mb-4">
            <div class="col-md-2">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-images fa-2x text-primary mb-2"></i>
                        <h3 class="text-primary">3</h3>
                        <p class="mb-0">Images Surveyed</p>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-exclamation-triangle fa-2x text-danger mb-2"></i>
                        <h3 class="text-danger">0</h3>
                        <p class="mb-0">Damaged Locations</p>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-percentage fa-2x text-warning mb-2"></i>
                        <h3 class="text-warning">0.0%</h3>
                        <p class="mb-0">Damage Rate</p>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-rupee-sign fa-2x text-success mb-2"></i>
                        <h3 class="text-success">₹0</h3>
                        <p class="mb-0">Repair Cost</p>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-clock fa-2x text-info mb-2"></i>
                        <h3 class="text-info">0h</h3>
                        <p class="mb-0">Repair Time</p>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-calendar fa-2x text-secondary mb-2"></i>
                        <h3 class="text-secondary">0</h3>
                        <p class="mb-0">Project Days</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Clean Area Message -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="alert alert-success">
                    <h4><i class="fas fa-check-circle"></i> Excellent News!</h4>
                    <p class="mb-0">No road damage was detected in this survey area. The road infrastructure appears to be in excellent condition.</p>
                </div>
            </div>
        </div>
        
        <!-- Recommendations -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-lightbulb"></i> Recommendations & Next Steps</h5>
                    </div>
                    <div class="card-body">
        
                    </div>
                </div>
            </div>
        </div>
        
    </div>
    
    <!-- Detailed Damage Modal -->
    <div class="modal fade" id="damageModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detailed Damage Analysis</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="damageModalBody">
                    <!-- Damage details will be loaded here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Image Modal -->
    <div class="modal fade" id="imageModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Image View</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="modalImage" src="" class="img-fluid" style="max-height: 80vh;">
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Damage data for modal
        const damageData = [];
        
        // Show detailed damage modal
        function showDamageModal(index) {
            const damage = damageData[index];
            const modalBody = document.getElementById('damageModalBody');
            
            // Fix image paths for modal display - use Flask routes
            let originalImagePath = damage.damaged_image_path || damage.detected_image_path;
            let detectedImagePath = damage.detected_image_path;
            
            // Ensure paths start with / for Flask routes
            if (originalImagePath && !originalImagePath.startsWith('/')) {
                originalImagePath = '/' + originalImagePath;
            }
            if (detectedImagePath && !detectedImagePath.startsWith('/')) {
                detectedImagePath = '/' + detectedImagePath;
            }
            
            let detailsHtml = `
                <div class="row">
                    <div class="col-md-6">
                        <h6>Original Image</h6>
                        <img src="${originalImagePath}" 
                             class="img-fluid rounded" 
                             onclick="showImageModal(this.src)"
                             style="cursor: pointer;"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIE5vdCBGb3VuZDwvdGV4dD48L3N2Zz4='">
                    </div>
                    <div class="col-md-6">
                        <h6>Detected Damages</h6>
                        <img src="${detectedImagePath}" 
                             class="img-fluid rounded"
                             onclick="showImageModal(this.src)"
                             style="cursor: pointer;"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIE5vdCBGb3VuZDwvdGV4dD48L3N2Zz4='">
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12">
                        <h6>Location Information</h6>
                        <div class="alert alert-info">
                            <i class="fas fa-map-marker-alt"></i>
                            <strong>Location:</strong> ${damage.latitude && damage.longitude ? 
                                `GPS Coordinates: ${damage.latitude.toFixed(6)}, ${damage.longitude.toFixed(6)}` : 
                                `Area: ${'Test_Image_Display'}`
                            }
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12">
                        <h6>Repair Analysis</h6>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Damage Type</th>
                                        <th>Severity</th>
                                        <th>Area (m²)</th>
                                        <th>Cost (₹)</th>
                                        <th>Time</th>
                                        <th>Method</th>
                                    </tr>
                                </thead>
                                <tbody>
            `;
            
            if (damage.detailed_damage_analysis) {
                damage.detailed_damage_analysis.forEach(analysis => {
                    detailsHtml += `
                                    <tr>
                                        <td>${analysis.damage_type.replace(/_/g, ' ')}</td>
                                        <td><span class="badge severity-${analysis.severity}">${analysis.severity}</span></td>
                                        <td>${analysis.area_sqm}</td>
                                        <td>₹${analysis.repair_cost.toFixed(0)}</td>
                                        <td>${analysis.repair_time_hours}h</td>
                                        <td><small>${analysis.repair_method}</small></td>
                                    </tr>
                    `;
                });
            }
            
            detailsHtml += `
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
            
            modalBody.innerHTML = detailsHtml;
            new bootstrap.Modal(document.getElementById('damageModal')).show();
        }
        
        // Show image in modal
        function showImageModal(imageSrc) {
            document.getElementById('modalImage').src = imageSrc;
            new bootstrap.Modal(document.getElementById('imageModal')).show();
        }
    </script>
</body>
</html>
        